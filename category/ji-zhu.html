<!DOCTYPE html>
<head>
    <meta charset="utf-8" />
    <!-- Set the viewport width to device width for mobile -->
    <meta name="viewport" content="width=device-width" />

    <title>West's blog - 技术</title>

    <link rel="stylesheet" href="http://szuwest.github.io/theme/css/normalize.css" />
    <link rel="stylesheet" href="http://szuwest.github.io/theme/css/foundation.min.css" />
    <link rel="stylesheet" href="http://szuwest.github.io/theme/css/style.css" />
    <link rel="stylesheet" href="http://szuwest.github.io/theme/css/pygments.css" />	
    <script src="http://szuwest.github.io/theme/js/custom.modernizr.js"></script>

    <!-- So Firefox can bookmark->"abo this site" -->

</head>

<body>

<!-- Nav Bar -->
<nav>
<div class="top-bar">
<div class="row">
    <div class="large-9 large-centered columns">
	    <h1><a href="http://szuwest.github.io">West's blog</a></h1>
    </div>
</div>
</div>

<!-- Show menu items and pages -->
<div class="row">
<div class="large-9 columns">
    <ul class="button-group navigation">

    </ul>
</div>
</div>
</nav>
<!-- End Nav -->


<!-- Main Page Content and Sidebar -->
<div class="row">

    <!-- Main Blog Content -->
    <div class="large-9 columns">
        
        

            <article>
                <a href="http://szuwest.github.io/svgtu-pian-zai-yi-dong-duan-de-ying-yong-jie-jue-fang-an.html"><h3 class="article-title">SVG图片在移动端的应用解决方案</h3></a>
<h6 class="subheader" title="2018-11-03T00:00:00">2018-11-03
</h6>


<h2>SVG图片在移动端的应用解决方案</h2>
<p>近几年来SVG使用得越来越多，就连Android的官方库也加入VectorDrawable的支持。这个类就是用来支持向量图的。SVG图片在web端使用非常广泛，我第一次接触这个也是在做react-native的项目中使用的。当时我们要做一些动画，需要从一个形状变换成另一个形状，这种一般都是用矢量图来做的。当时设计师就给了我一些矢量图，于是我就开始研究这个东西。</p>
<p>在react-native中，有专门一个库叫<a href="https://github.com/react-native-community/react-native-svg">react-native-svg</a>来处理这个。不过当时要做两个SVG形状的动画变化，并不是任何一个形状都可以的，需要遵循一定的标准。设计师给我的两个SVG文件并不能转换。后来是我自己根据文件里的一些关键参数自己在代码里直接画出来后，再做转换动画。</p>
<p>最近我在做的native项目中，也遇到了要用SVG的图片。我们的项目里要从服务器下载SVG图片来展示。我们要实现的这些文件是需要服务器动态配置的，也就是说我们不能预先打包进我们的APP里。所以我们这里的要提供一个解决方案，跟图片JPG图片一样显示，缓存。</p>
<p>这个需求跟之前我遇到的那个需求是很不一样的，之前的是设计师已经定义好图片，我们工程师直接拿到文件在程序里展示，不需要考虑下载和缓存之类的。这种需求其实很简单，我们实际上大部分的需求就是这种需求，网上有很多库可以完成这种需求。把SVG图片跟JPG等普通图片一样使用，网上的方案还真不多，特别是iOS方面。。。。</p>
<p>要像普通图片一样使用，就要考虑下载，本地缓存，内存缓存。像这种需求，我们移动端都会使用专门的图片框架，像安卓端的glide，UIL等，iOS端的SDWebImage等。但是这种库它是默认都不会考虑SVG图片。但是我们最好还是像使用这种框架来处理SVG图片。最好的方式就是把SVG的支持集成到这些库中。好在这些库的优点就是容易扩展。</p>
<h3>安卓端的解决方案</h3>
<p>由于我们的项目是采用glide框架来处理图片，所以这里就只讲在这个框架集成SVG图片的展示。</p>
<p>实际上glide真的是一个很强大的库，怪不得那么多人用它（早几年我们都是用UIL），它在它的sample例子里就提供了SVG的展示支持<a href="https://github.com/bumptech/glide/tree/master/samples/svg">svg</a>。在这个例子里，采用的SVG解码方式是使用外部的解码库。它采用的解码库是<a href="https://github.com/BigBadaboom/androidsvg">androidsvg</a>。这个库是web端移植过来的，所以它有很好的兼容性，是很不错的库，虽然它的star不是很多。Android就是好，有强大的Java社区，受益于这些社区，很多库都不错。而这方面iOS就那么好了，这个等一下再说。</p>
<p>按照它提供的sample来集成SVG的支持，不是很难。但是我遇到了其他问题。因为我们项目里的glide使用的是3.7版本，sample是基于4.8版本的。这两个版本在API上有很大区别，变化很大。所以我必须要先升级到4.8版本。等我升级完后，接入SVG的支持，然而SVG图片死活显示不出来。最终发现是我的AppModule无法生成。一直在文档，查资料，还是找不到问题，我是完全按照官方文档升级和集成的。最终我发现可能是跟AndroidX相关（还不知道AndroidX是什么的自己查）。我们项目升级到了AndroidX，它会影响一些annotation生成方式。我们的项目采用插件式框架。我们很多通用库是放在一个commomlibrary的Module中，glide也是。APP module就只是一个壳。但是一些annotation的声明一定要放在APP module中才行。所以我们把 </p>
<div class="highlight"><pre><span class="n">annotationProcessor</span> <span class="err">&#39;</span><span class="n">androidx</span><span class="p">.</span><span class="n">annotation</span><span class="o">:</span><span class="n">annotation</span><span class="o">:</span><span class="mf">1.0.0</span><span class="err">&#39;</span>
<span class="n">annotationProcessor</span> <span class="err">&#39;</span><span class="n">com</span><span class="p">.</span><span class="n">github</span><span class="p">.</span><span class="n">bumptech</span><span class="p">.</span><span class="n">glide</span><span class="o">:</span><span class="n">compiler</span><span class="o">:</span><span class="mf">4.8.0</span><span class="err">&#39;</span> 
</pre></div>


<p>放在了APP module中，最终那些自动生成的代码才会真正的生成。这样就可以很愉快的用glide来显示SVG图片了。</p>
<div class="highlight"><pre><span class="n">public</span> <span class="n">class</span> <span class="n">GlideSvgUtil</span> <span class="p">{</span>

    <span class="c1">//显示网络中的svg文件</span>
    <span class="n">public</span> <span class="k">static</span> <span class="kt">void</span> <span class="n">showSvg</span><span class="p">(</span><span class="n">ImageView</span> <span class="n">imageView</span><span class="p">,</span> <span class="n">String</span> <span class="n">url</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Glide</span><span class="p">.</span><span class="n">with</span><span class="p">(</span><span class="n">imageView</span><span class="p">.</span><span class="n">getContext</span><span class="p">()).</span><span class="n">as</span><span class="p">(</span><span class="n">PictureDrawable</span><span class="p">.</span><span class="n">class</span><span class="p">).</span><span class="n">listener</span><span class="p">(</span><span class="n">new</span> <span class="n">SvgSoftwareLayerSetter</span><span class="p">()).</span><span class="n">load</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">into</span><span class="p">(</span><span class="n">imageView</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">//把svg放入到raw中，通过rawid来显示</span>
    <span class="n">public</span> <span class="k">static</span> <span class="kt">void</span> <span class="n">showSvgRes</span><span class="p">(</span><span class="n">ImageView</span> <span class="n">imageView</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rawId</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Uri</span> <span class="n">uri</span> <span class="o">=</span> <span class="n">Uri</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">ContentResolver</span><span class="p">.</span><span class="n">SCHEME_ANDROID_RESOURCE</span> <span class="o">+</span> <span class="s">&quot;://&quot;</span> <span class="o">+</span> <span class="n">imageView</span><span class="p">.</span><span class="n">getContext</span><span class="p">().</span><span class="n">getPackageName</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span>
                <span class="o">+</span> <span class="n">rawId</span><span class="p">);</span>
        <span class="n">Glide</span><span class="p">.</span><span class="n">with</span><span class="p">(</span><span class="n">imageView</span><span class="p">.</span><span class="n">getContext</span><span class="p">()).</span><span class="n">as</span><span class="p">(</span><span class="n">PictureDrawable</span><span class="p">.</span><span class="n">class</span><span class="p">).</span><span class="n">listener</span><span class="p">(</span><span class="n">new</span> <span class="n">SvgSoftwareLayerSetter</span><span class="p">()).</span><span class="n">load</span><span class="p">(</span><span class="n">uri</span><span class="p">).</span><span class="n">into</span><span class="p">(</span><span class="n">imageView</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">//把svg的XML加载到字符串中来显示</span>
    <span class="n">public</span> <span class="k">static</span> <span class="kt">void</span> <span class="n">showSvgContent</span><span class="p">(</span><span class="n">ImageView</span> <span class="n">imageView</span><span class="p">,</span> <span class="n">String</span> <span class="n">svgContent</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Glide</span><span class="p">.</span><span class="n">with</span><span class="p">(</span><span class="n">imageView</span><span class="p">.</span><span class="n">getContext</span><span class="p">()).</span><span class="n">as</span><span class="p">(</span><span class="n">PictureDrawable</span><span class="p">.</span><span class="n">class</span><span class="p">).</span><span class="n">listener</span><span class="p">(</span><span class="n">new</span> <span class="n">SvgSoftwareLayerSetter</span><span class="p">()).</span><span class="n">load</span><span class="p">(</span><span class="n">svgContent</span><span class="p">.</span><span class="n">getBytes</span><span class="p">()).</span><span class="n">into</span><span class="p">(</span><span class="n">imageView</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h3>iOS端的解决方案</h3>
<p>iOS的方案还不是很好解决，我没有发现有哪一个图片框架是集成了SVG或者提供了集成的例子的。而且我们的同事还发现了一个问题。我们服务器提供的SVG图片在很多库解码出来后没有了颜色，是黑白的。很诡异的问题，然而安卓端没有这问题。我们找很多库，像SVGKit，SwiftSVG，PocketSVG，Macaw，这些库都是超过1000star的，都无法正常显示。我基本确定是我们SVG文件的兼容性问题，我问我们的设计师他是怎么生成SVG文件的。他说是用sketch导出来的。这些文件在web和安卓的库，还有甚至xcode里都是能正常显示的。这里我提供一个不能正常显示的图片。</p>
<div class="highlight"><pre><span class="nt">&lt;svg</span> <span class="na">id=</span><span class="s">&quot;图层_1&quot;</span> <span class="na">data-name=</span><span class="s">&quot;图层 1&quot;</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="na">viewBox=</span><span class="s">&quot;0 0 80 80&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;defs&gt;&lt;style&gt;</span>.cls-1{fill:#ff9595;}.cls-2{fill:#ffcc80;}<span class="nt">&lt;/style&gt;&lt;/defs&gt;</span>
<span class="nt">&lt;title&gt;</span>彩色图标<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;path</span> <span class="na">class=</span><span class="s">&quot;cls-1&quot;</span> <span class="na">d=</span><span class="s">&quot;M43,77A27.14,27.14,0,0,0,58.64,27.67a24.55,24.55,0,0,1-6.4,8A24.44,24.44,0,0,0,34.55,3a24.48,24.48,0,0,1,.87,6.49c0,21.19-25.57,21.72-25.57,42.37C9.85,64.9,20.47,77,43,77Z&quot;</span><span class="nt">/&gt;&lt;path</span> <span class="na">class=</span><span class="s">&quot;cls-2&quot;</span> <span class="na">d=</span><span class="s">&quot;M51,66c0-9.28-11.79-11.85-11.79-21.74A12.3,12.3,0,0,1,40,39.95,20.79,20.79,0,0,0,34.77,76.4,54.34,54.34,0,0,0,43,77c.86,0,1.7,0,2.53-.12A13.47,13.47,0,0,0,51,66Z&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</pre></div>


<p>因为是颜色不能正常显示，我猜肯定是defs标签里的内容不能正常解析。我稍微改了下文件，就能正常显示了。我还发现对SVG显示支持的比较好的是Macaw，其他的貌似都有点小问题。所以我把这个问题在Macaw上提交了。我不知道他们会什么时候修改，所以我就自己去研究他们的源代码，准备自己来解决了。很快我就发现他们在预解析阶段，解析defs标签的时候，就没有考虑style这种子标签。所以我就加上去了，就两三行代码（他们的代码架构挺好），然后就正常显示了。后来我又到Macaw网站上看，他们已经回复我了，并且已经支持！前后也就一个多小时！他说defs标签里一般不会放style标签，不过很多其他库支持，所以他们也就支持了。我去看他改的代码，几乎跟我改一样。所以我就放弃自己的改动，采用cocoapods直接拉取他们的master上的最新代码。</p>
<p>解码的问题解决了，但是怎么集成到图片框架里呢？我们项目是采用swift开发的，我们采用的图片处理框架是Kingfisher。我去Kingfisher的网站上看，喵神很厉害，已经有很好的文档教我们怎么扩展图片解码器。我一看，另一个问题来了，解码器是在工作线程中进行的，并且要返回一个UIImage。Macaw这个库并没有提供一个可以在子线程中将SVG文件转为UIImage的方法。他们的方法是将SVG显示在一个UIView里然后截图。。。也有人将这个问题提了。我看他们源码发现有支持的，但是没有放出来，无法使用。</p>
<p>我最终也只能采用曲线救国的方法了。还是用他们的方法，我在解码线程里同步切到主线程中生成UIImage，然后再在子线程中返回这个UIImage。好消息是，最近两天，他们终于支持将一个文件直接转换为UIImage了具体方案看<a href="https://github.com/exyte/Macaw/issues/468">这里</a>，不过我还没测试，他们也还没发新版。</p>
<p>SVG解码器</p>
<div class="highlight"><pre><span class="n">import</span> <span class="n">Foundation</span>
<span class="n">import</span> <span class="n">UIKit</span>
<span class="n">import</span> <span class="n">Kingfisher</span>
<span class="n">import</span> <span class="n">Macaw</span>

<span class="k">struct</span> <span class="n">SVGProcessor</span><span class="o">:</span>  <span class="n">ImageProcessor</span> <span class="p">{</span>
    <span class="n">var</span> <span class="n">size</span> <span class="o">=</span> <span class="n">CGSize</span><span class="p">(</span><span class="n">width</span><span class="o">:</span> <span class="mi">32</span><span class="p">,</span> <span class="n">height</span><span class="o">:</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">init</span><span class="p">(</span><span class="n">_</span> <span class="n">size</span><span class="o">:</span> <span class="n">CGSize</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">size</span><span class="p">.</span><span class="n">width</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">size</span><span class="p">.</span><span class="n">height</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
            <span class="n">print</span><span class="p">(</span><span class="s">&quot;不支持size为0的情况m，将采用默认值32&quot;</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">self</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">let</span> <span class="n">identifier</span><span class="o">:</span> <span class="n">String</span> <span class="o">=</span> <span class="s">&quot;com.wegene.future&quot;</span>

    <span class="n">func</span> <span class="n">process</span><span class="p">(</span><span class="n">item</span><span class="o">:</span> <span class="n">ImageProcessItem</span><span class="p">,</span> <span class="n">options</span><span class="o">:</span> <span class="n">KingfisherOptionsInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">UIImage</span><span class="o">?</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="n">item</span> <span class="p">{</span>
        <span class="k">case</span> <span class="p">.</span><span class="n">image</span><span class="p">(</span><span class="n">let</span> <span class="n">image</span><span class="p">)</span>:
            <span class="n">print</span><span class="p">(</span><span class="s">&quot;already an image&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">image</span>
        <span class="k">case</span> <span class="p">.</span><span class="n">data</span><span class="p">(</span><span class="n">let</span> <span class="n">data</span><span class="p">)</span>:
            <span class="n">let</span> <span class="n">svgContent</span> <span class="o">=</span> <span class="n">String</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">data</span><span class="o">:</span> <span class="n">data</span><span class="p">,</span> <span class="n">encoding</span><span class="o">:</span> <span class="n">String</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="n">utf8</span><span class="p">)</span>
            <span class="n">var</span> <span class="n">img</span><span class="o">:</span> <span class="n">UIImage</span><span class="o">?</span>
            <span class="n">DispatchQueue</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="n">sync</span> <span class="p">{</span><span class="c1">//现在Macaw库暂时只支持这种方式生成UIImage,下一版他们支持后台线程生成UIImage的方式，以后再做修改</span>
                <span class="n">let</span> <span class="n">rootNode</span> <span class="o">=</span> <span class="n">try</span><span class="o">!</span> <span class="n">SVGParser</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">text</span><span class="o">:</span> <span class="n">svgContent</span><span class="o">!</span><span class="p">)</span>
                <span class="n">let</span> <span class="n">macawView</span> <span class="o">=</span> <span class="n">MacawView</span><span class="p">(</span><span class="n">node</span><span class="o">:</span> <span class="n">rootNode</span><span class="p">,</span> <span class="n">frame</span><span class="o">:</span><span class="n">CGRect</span><span class="p">(</span><span class="n">origin</span><span class="o">:</span> <span class="n">CGPoint</span><span class="p">.</span><span class="n">zero</span><span class="p">,</span> <span class="n">size</span><span class="o">:</span> <span class="n">size</span><span class="p">))</span>
                <span class="n">UIGraphicsBeginImageContextWithOptions</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="n">UIScreen</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="n">scale</span><span class="p">)</span>
                <span class="n">macawView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="n">in</span><span class="o">:</span> <span class="n">UIGraphicsGetCurrentContext</span><span class="p">()</span><span class="o">!</span><span class="p">)</span>
                <span class="n">img</span> <span class="o">=</span>  <span class="n">UIGraphicsGetImageFromCurrentImageContext</span><span class="p">();</span>
                <span class="n">UIGraphicsEndImageContext</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">img</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>UIImageView的扩展</p>
<div class="highlight"><pre><span class="n">extension</span> <span class="n">UIImageView</span> <span class="p">{</span>
    <span class="n">func</span> <span class="n">setSvgImage</span><span class="p">(</span><span class="n">_</span> <span class="n">url</span><span class="o">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">let</span> <span class="n">processor</span> <span class="o">=</span> <span class="n">SVGProcessor</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">)</span>
        <span class="n">let</span> <span class="n">_url</span> <span class="o">=</span> <span class="n">URL</span><span class="p">(</span><span class="n">string</span><span class="o">:</span> <span class="n">url</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">kf</span><span class="p">.</span><span class="n">setImage</span><span class="p">(</span><span class="n">with</span><span class="o">:</span> <span class="n">_url</span><span class="p">,</span> <span class="n">options</span><span class="o">:</span><span class="p">[.</span><span class="n">processor</span><span class="p">(</span><span class="n">processor</span><span class="p">)])</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>谢谢阅读。</p>
<hr />
<p>如果你觉得这篇文章有用，请打赏小钱喝杯咖啡^_^
<img alt="打赏" src="https://raw.githubusercontent.com/szuwest/szuwest.github.io/master/images/2018-02-21%20133111.jpg" /></p><p class="subheader">Category: <a href="http://szuwest.github.io/category/ji-zhu.html">技术</a>

    Tagged: 
    <a href="http://szuwest.github.io/tag/suan-fa-svg-androidsvg-glide-macaw.html">算法 SVG androidsvg glide Macaw </a>
</p>



<p><a href="http://szuwest.github.io/svgtu-pian-zai-yi-dong-duan-de-ying-yong-jie-jue-fang-an.html#disqus_thread">comments</a></p>            </article>


                <hr  class="gradient"/>


        


            <article>
                <a href="http://szuwest.github.io/duo-jia-gong-si-de-ren-zheng-bi-dui-suan-fa-ti-yan-he-kai-fa-gan-xiang.html"><h3 class="article-title">多家公司的人证比对算法体验和开发感想</h3></a>
<h6 class="subheader" title="2018-07-13T00:00:00">2018-07-13
</h6>


<h1>多家公司的人证比对算法体验和开发感想</h1>
<p>最近在开发一个声纹采集一体机系统，这个系统里用到了人证比对功能，即刷身份证后拍照，然后将身份证里面的照片跟拍照比对，验证是否是同一个人。我们不是做人脸识别的公司，所以人脸识别功能当然是接入别人的SDK，这里我们找了好多家的人脸算法，对接过程中也遇到很多问题。经过这次的开发，我了解到这个行业的一些现状。</p>
<p>我们的系统主要运行在Windows电脑上，而且需要无网络也能使用，所以人脸算法必须是用离线版的。人脸算法厂家一般对外提供两种方式：在线版和离线版。一般在线版都可以提供免费试用，离线版需要授权使用。</p>
<h2>云端方案</h2>
<p>在线版的人脸识别我试用过依图科技的和中科视拓的SDK。在我们的应用声临其境APP上有个声纹购物的场景，需要人脸验证。这两个厂家提供的API都差不多，依图的API安全性考虑更全面，错误码定义的比较详细。还有他们的API共同点是，图片传输都是将图片数据进行base64编码后传输的。至于准确率，感觉都差不多，没有特别明显的差距。</p>
<h2>离线方案</h2>
<p>离线版的人脸算法用得比对多。因为它是用在我们要卖的机器上，而在线版的我们只是做试验。离线版的集成和使用要比在线版麻烦很多。由于离线版要给出算法库，处于安全和容易被拷贝的原因，都是要先授权的。授权的方式一般有两种：在设备上接入加密狗USB key或者绑定设备机器码的方式。加密狗方式比较方便，我们一般采用这种方式。</p>
<p>我们接入了很多厂家，有阅面科技，中控，杰锐达，商汤，我还把开源的dlib人脸识别也接入了 ...</p><p class="subheader">Category: <a href="http://szuwest.github.io/category/ji-zhu.html">技术</a>

    Tagged: 
    <a href="http://szuwest.github.io/tag/ren-lian-jian-ce-ren-zheng-bi-dui-dlib-electron.html">人脸检测 人证比对 dlib electron </a>
</p>



<p><a href="http://szuwest.github.io/duo-jia-gong-si-de-ren-zheng-bi-dui-suan-fa-ti-yan-he-kai-fa-gan-xiang.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://szuwest.github.io/duo-jia-gong-si-de-ren-zheng-bi-dui-suan-fa-ti-yan-he-kai-fa-gan-xiang.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://szuwest.github.io/flutterkuang-jia-yan-jiu-he-yu-rndui-bi.html"><h3 class="article-title">Flutter框架研究和与RN对比</h3></a>
<h6 class="subheader" title="2018-03-16T00:00:00">2018-03-16
</h6>


<h2>Flutter是什么</h2>
<p>现在技术更新迭代真的很快，每隔几年就会出现一些新的技术。当然，Flutter出现有有一点时间了，只不过还未真是发布，但是已经有一些人在使用了。这篇文章主要内容来自我在公司内部的一次分享会，所以大部分内容都是提炼。</p>
<ul>
<li>Flutter 是由 Google 的工程师团队打造的，用于创建高性能、跨平台的移动应用的框架。</li>
<li>Flutter 针对当下以及未来的移动设备进行优化，专注于 Android and iOS 低延迟的输入和高帧率</li>
<li>Flutter的设计跟react-native很像，但是比RN进了一步</li>
<li>Flutter的开发语言是Dart</li>
</ul>
<h2>移动端跨平台开发技术演进</h2>
<p>现在主流的移动开发平台是Android和iOS，之前还有过windows phone，每个平台的开发技术都不太一样。大家都是针对每个平台开发应用。自然有人就会觉得这样效率低下，想进行跨平台开发。从最开始的Hybrid混合开发技术，到RN的桥接技术，到现在新兴的Flutter技术，跨平台开发技术一直在演进。</p>
<p>以往最早的Hybrid开发，主要依赖于WebView。但是WebView是一个很重的控件，很容易产生内存问题，而且复杂的UI在WebView上显示的性能不好。react-native技术抛开了WebView，利用JavaScriptCore来做桥接，将js调用转为native调用，只牺牲了小部分性能获取的跨平台开发，这是一大进步。所以现在react-native很流行的原因。</p>
<p><img alt="react-native原理图" src="https://res.infoq.com/articles/why-is-flutter-revolutionary/zh/resources/2.png" /></p>
<p>上图react-native框架原理</p>
<p>Flutter实现跨平台采用了更为彻底的方案 ...</p><p class="subheader">Category: <a href="http://szuwest.github.io/category/ji-zhu.html">技术</a>

    Tagged: 
    <a href="http://szuwest.github.io/tag/reactnative-flutter.html">ReactNative Flutter </a>
</p>



<p><a href="http://szuwest.github.io/flutterkuang-jia-yan-jiu-he-yu-rndui-bi.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://szuwest.github.io/flutterkuang-jia-yan-jiu-he-yu-rndui-bi.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://szuwest.github.io/jenkins-slave-reactnativexiang-mu-zi-dong-da-bao.html"><h3 class="article-title">Jenkins slave ReactNative项目自动打包</h3></a>
<h6 class="subheader" title="2018-03-08T00:00:00">2018-03-08
</h6>


<h1>Jenkins slave ReactNative项目自动打包</h1>
<p>这次我想在谈谈Jenkins自动打包的问题。针对react-native项目。
一般情况下，我们都是在一台电脑上安装Jenkins，然后在该电脑上打开Jenkins网页进行打包配置。如果我们有很多项目，分布在不同的电脑，而且运行的系统也不同，这时候我们需要一个master来统一管理这些电脑，然后统一在一个网页上进行打包配置。这就是Jenkins的master-slave打包模式。这种模式跟单机模式稍有不同，这里主要讲怎么配置slave。</p>
<h2>slave节点配置</h2>
<ul>
<li>首先slave上也同样要安装Jenkins和相关的打包所依赖的环境，一个都不能少。配置好之后，我们并不需要在本机上打开Jenkins网页来创建项目，配置项目等，而是要到主机上去配置。在去主机的Jenkins管理页面上新建节点之前，从机还需要做一些其他配置。</li>
<li>打开远程登录。在系统设置--&gt;共享，然后选中远程登录，允许所有用户访问。</li>
<li>记住本机IP地址。在系统设置--&gt;网络，可以看到当前网络的IP地址。为了以后方便，可以将IP地址设置为一个固定IP地址。不然当该电脑重启之后，IP地址可能会变，然后主机再按照之前配置的旧IP连接从机的时候，就连不上了。Mac电脑配置固定IP也有注意的地方。我第一次配置就是没有成功，上不了网。选择手动方式，然后填上一个没有被占用的IP地址，然后，子网掩码也要注意，如果跟服务器是跨网段访问的，需要注意255.255 ...</li></ul><p class="subheader">Category: <a href="http://szuwest.github.io/category/ji-zhu.html">技术</a>

    Tagged: 
    <a href="http://szuwest.github.io/tag/reactnative-jenkins-ios.html">ReactNative Jenkins iOS </a>
</p>



<p><a href="http://szuwest.github.io/jenkins-slave-reactnativexiang-mu-zi-dong-da-bao.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://szuwest.github.io/jenkins-slave-reactnativexiang-mu-zi-dong-da-bao.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://szuwest.github.io/react-nativekuang-jia-yuan-ma-xue-xi-iosxia.html"><h3 class="article-title">react-native框架源码学习(iOS)(下)</h3></a>
<h6 class="subheader" title="2018-03-02T00:00:00">2018-03-02
</h6>


<h1>react-native框架源码学习(iOS)(下)</h1>
<p>如果没有看过上篇，请先看<a href="">react-native框架源码学习(iOS)(上)</a>。</p>
<h3>JSCExecutor相关初始化</h3>
<p>在上篇中说到Instance的初始化方法initializeBridge里，最主要是创建了NativeToJsBridge的实例。而NativeToJsBridge的构造函数里，主要是调用了executorFactory来创建一个JSCExecutor。NativeToJsBridge的构造函数还包含更多的东西。</p>
<div class="highlight"><pre><span class="n">NativeToJsBridge</span><span class="o">::</span><span class="n">NativeToJsBridge</span><span class="p">(</span>
    <span class="n">JSExecutorFactory</span><span class="o">*</span> <span class="n">jsExecutorFactory</span><span class="p">,</span>
    <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">ModuleRegistry</span><span class="o">&gt;</span> <span class="n">registry</span><span class="p">,</span>
    <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">MessageQueueThread</span><span class="o">&gt;</span> <span class="n">jsQueue</span><span class="p">,</span>
    <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">InstanceCallback</span><span class="o">&gt;</span> <span class="n">callback</span><span class="p">)</span>
    <span class="o">:</span> <span class="n">m_destroyed</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="p">(</span><span class="nb">false</span><span class="p">))</span>
    <span class="p">,</span> <span class="n">m_delegate</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">JsToNativeBridge</span><span class="o">&gt;</span><span class="p">(</span><span class="n">registry</span><span class="p">,</span> <span class="n">callback</span><span class="p">))</span>
    <span class="p">,</span> <span class="n">m_executor</span><span class="p">(</span><span class="n">jsExecutorFactory</span><span class="o">-&gt;</span><span class="n">createJSExecutor</span><span class="p">(</span><span class="n">m_delegate</span><span class="p">,</span> <span class="n">jsQueue</span><span class="p">))</span>
    <span class="p">,</span> <span class="n">m_executorMessageQueueThread</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">jsQueue ...</span></pre></div><p class="subheader">Category: <a href="http://szuwest.github.io/category/ji-zhu.html">技术</a>

    Tagged: 
    <a href="http://szuwest.github.io/tag/reactnative-yuan-ma-ios.html">ReactNative 源码 iOS </a>
</p>



<p><a href="http://szuwest.github.io/react-nativekuang-jia-yuan-ma-xue-xi-iosxia.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://szuwest.github.io/react-nativekuang-jia-yuan-ma-xue-xi-iosxia.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://szuwest.github.io/react-nativekuang-jia-yuan-ma-xue-xi-iosshang.html"><h3 class="article-title">react-native框架源码学习(iOS)(上)</h3></a>
<h6 class="subheader" title="2018-02-26T00:00:00">2018-02-26
</h6>


<h1>react-native框架源码学习(iOS)(上)</h1>
<h2>注意事项</h2>
<p>要学习react-native框架iOS端源码，先要了解一下注意的事项。</p>
<ul>
<li>一、 首先需要非常熟悉objective-c语言，对OC的runtime机制更是必不可少。源码里大量用了runtime特性。然后也要熟悉c++语言。除了OC语言，里面还有大量的c++代码，OC与c++混合代码。对c++的template和std库也要熟悉。我本人对c++也熟悉，但是不够深入，对一些高级特性不是很了解，所以相关的一些代码看起来很吃力。最后当然也熟悉js语言。我大学时学习过js，但是那还真是远古时代了，js近年来发展很快，我对很多新特性不是很了解，这也对我学习有一定的阻碍。另外还有要比较了解iOS的JavaScriptCore框架，这个是js与OC通信的基础。</li>
<li>二、 要对react-native的版本了解。查看网上的资料时也要注意他们所说的RN版本。现在网上很多研究资料，他们所研究的版本都是很早之前的版本。新的版本跟老版本有很多细节和流程改变了。如果你发现有些文章里说的东西跟你所看到的对不上，那就是研究的版本不一致。</li>
<li>三、如果看不懂，多看看别人的分析文章。如果对某种语言或者框架库不熟悉，建议先把该补的补上。</li>
</ul>
<p>我所研究的RN版本是<strong>0.49</strong>，而最新版是0.51 ...</p><p class="subheader">Category: <a href="http://szuwest.github.io/category/ji-zhu.html">技术</a>

    Tagged: 
    <a href="http://szuwest.github.io/tag/reactnative-yuan-ma-ios.html">ReactNative 源码 iOS </a>
</p>



<p><a href="http://szuwest.github.io/react-nativekuang-jia-yuan-ma-xue-xi-iosshang.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://szuwest.github.io/react-nativekuang-jia-yuan-ma-xue-xi-iosshang.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://szuwest.github.io/qian-tan-reactnativeji-zhu-de-you-lie.html"><h3 class="article-title">浅谈ReactNative技术的优劣</h3></a>
<h6 class="subheader" title="2018-02-06T00:00:00">2018-02-06
</h6>


<h1>浅谈ReactNative技术的优劣</h1>
<p>去年大概10月份开始使用ReactNative技术来开发项目，现在也已经有几个月时间了。也上线了三个ReactNative开发的项目。一直想谈谈使用ReactNative的开发感受。</p>
<ul>
<li>使用react-native确实可以提高界面开发效率，因为两个平台，只需要编写一套代码。react-native在这方面做了很多工作，让界面开发跟web开发基本一致。web开发人员可以很方便的写react-native界面，不需要二次学习。而且在react-native里面的像素是逻辑像素，可以比较好的适配界面。</li>
<li>react-native界面开发方式跟web开发是基本一致的，这跟native开发界面有很大不同。react-native界面开发是声明式开发，而且是继承于react框架，而纯native开发人员根本不了解这个框架，需要学习成本。它的View布局层次跟原生的布局层次不太一样。我自己也搞了挺久才搞清楚。</li>
<li>react-native很适合那些纯http数据交互的应用。即那些数据和内容都是从服务器拉取，APP只是展示和消费的场景应用。这样不但界面可以react-native来写，HTTP请求也可以很方便的用ReactNative来写。</li>
<li>react-native不适合用于那些需要复杂的通信方式的应用，也不适用于那些强多媒体资源的应用，例如要做相册，音视频播放的应用。因为react-native上不方便用socket的那些通信方法，需要自己封装。然后内存问题也不太好把控。对于相册，多媒体播放，ReactNative也没有封装。</li>
<li>react-native对于web转native开发是很有用，对纯native开发转react-native开发不是很友好，主要是思维方式发生比较大的变化。</li>
<li>react-native不能隔绝native开发的知识。要做APP开发，最终还是需懂得native开发的一些知识，react-native并不能完全屏蔽这些。一个纯web开发想要转react-native开发，还是需要懂native开发的人来帮助和指导，或者自己需要先学习native相关知识。</li>
</ul>
<h1>react-native开发会是未来的方向吗</h1>
<p>这个我也不敢说。不过ReactNative开发未来会代替掉一些native发 ...</p><p class="subheader">Category: <a href="http://szuwest.github.io/category/ji-zhu.html">技术</a>

    Tagged: 
    <a href="http://szuwest.github.io/tag/react-native.html">react-native </a>
</p>



<p><a href="http://szuwest.github.io/qian-tan-reactnativeji-zhu-de-you-lie.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://szuwest.github.io/qian-tan-reactnativeji-zhu-de-you-lie.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://szuwest.github.io/code-reviewfang-an.html"><h3 class="article-title">Code Review方案</h3></a>
<h6 class="subheader" title="2018-01-10T00:00:00">2018-01-10
</h6>


<h1>Code Review方案</h1>
<h2>定义</h2>
<p>Code Review代码评审是指在软件开发过程中，通过对源代码进行系统性检查的过程。通常的目的是查找各种缺陷，包括代码缺陷、功能实现问题、编码合理性、性能优化等；保证软件总体质量和提高开发者自身水平</p>
<h2>code review 的好处</h2>
<ul>
<li>
<ol>
<li>提高代码质量。</li>
</ol>
</li>
<li>
<ol>
<li>及早发现潜在缺陷，降低修改/弥补缺陷的成本。</li>
</ol>
</li>
<li>
<ol>
<li>促进团队内部知识共享，提高团队整体水平。</li>
</ol>
</li>
<li>
<ol>
<li>评审过程对于评审人员来说，也是一种思路重构的过程。帮助更多的人理解系统。</li>
</ol>
</li>
<li>
<ol>
<li>是一个传递知识的手段，可以让其它并不熟悉代码的人知道作者的意图和想法，从而可以在以后轻松维护代码。</li>
</ol>
</li>
<li>
<ol>
<li>鼓励程序员们相互学习对方的长处和优点。 </li>
</ol>
</li>
<li>
<ol>
<li>可以被用来确认自己的设计和实现是一个清楚和简单的。</li>
</ol>
</li>
</ul>
<h2>code review形式</h2>
<p>一般code review有两种形式，一种是代码评审会议，我称之为Code Review Meeting，就是将团队成员都组织起来开会，让代码Owner上去讲自己代码的实现和思路，其它人发表意见和进行讨论，也有把这种叫做team review。另外一种是一对一评审，我称之为Single Review，就是项目owner提交代码之后，让reviewer在空闲的时候帮忙评审代码，并且写出批注，owner收到批注后，进行修改或者回复 ...</p><p class="subheader">Category: <a href="http://szuwest.github.io/category/ji-zhu.html">技术</a>

    Tagged: 
    <a href="http://szuwest.github.io/tag/codereview.html">codereview </a>
</p>



<p><a href="http://szuwest.github.io/code-reviewfang-an.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://szuwest.github.io/code-reviewfang-an.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://szuwest.github.io/shou-ji-ju-yu-wang-nei-bao-gua-re-dian-fa-xian-he-zu-wang-tong-xun-shi-xian.html"><h3 class="article-title">手机局域网内（包括热点）发现和组网通讯实现</h3></a>
<h6 class="subheader" title="2017-11-05T00:00:00">2017-11-05
</h6>


<h1>手机局域网内（包括热点）组网通讯实现</h1>
<p>最近在做一个应用，需要多个手机一起组网，一个充当主机，其他多个手机充当从机。主机跟每个从机之间可以相互通信，发送消息和文件。这不就是个CS（client-server）模式吗，只不过server不是在云端，只是在同一个局域网的手机上罢了。</p>
<p>这里面有两个关键的地方，一个是如何发现同一个局域网内的手机客户端，包括自建的热点，一个是知道各个手机的Ip地址后，用什么方式来建立通信。这里说一下热点，手机开启热点之后，别的手机连上这个特点，其实也是一个小型局域网，只不过这个局域网稍微有点不一样（Ip地址），其他的都一样。</p>
<h2>局域网发现</h2>
<p>局域网发现主要难点在于如何得到对方Ip地址。我们的做法是发送UDP包。UDP协议是无面向连接的，也就是不需要像TCP协议那样提前建立连接。所以我们向局域网内某一个特定的端口广播UDP包，接收到这个包的人，发送回包，那么我们就知道彼此的存在和地址。</p>
<p>那么关键地方是</p>
<ul>
<li>有人一直在监听一个端口X，接收UDP包</li>
<li>有人在一直往这个端口X发送UDP包</li>
</ul>
<p>监听端的人收到了UDP包后，就知道了发送者的Ip地址。但这时发送者是不知道接收者的，因为这是UDP包，无连接的状态的。那怎么做才让发送者也知道了。其实只要发过来再做一次就行。发送者同时也是监听者，这就行了。不过发送者A监听的是另一个端口Y，接收者B接收到包后 ...</p><p class="subheader">Category: <a href="http://szuwest.github.io/category/ji-zhu.html">技术</a>

    Tagged: 
    <a href="http://szuwest.github.io/tag/ju-yu-wang-re-dian-tong-xun-yan-bo-websocket.html">局域网 热点 通讯 广播 WebSocket </a>
</p>



<p><a href="http://szuwest.github.io/shou-ji-ju-yu-wang-nei-bao-gua-re-dian-fa-xian-he-zu-wang-tong-xun-shi-xian.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://szuwest.github.io/shou-ji-ju-yu-wang-nei-bao-gua-re-dian-fa-xian-he-zu-wang-tong-xun-shi-xian.html">Read More</a>
                <hr  class="gradient"/>
            </article>

        


            <article>
                <a href="http://szuwest.github.io/sheng-wen-shi-bie-zhi-androidshou-ji-lu-yin-cai-ji-tan-tao.html"><h3 class="article-title">声纹识别之Android手机录音采集探讨</h3></a>
<h6 class="subheader" title="2017-10-08T00:00:00">2017-10-08
</h6>


<h1>声纹识别之Android手机录音采集探讨</h1>
<p>声纹识别是人工智能语音方向的一个重要分支。最近人工智能的兴起也带动了声纹识别这一领域的发展。声纹识别也越来越准确。不过在声音采集方面，特别是手机端的声音采集，是一个很讲究的问题。我加入人工智能声纹识别公司也有两个多月了，对手机端的语音采集也有了一定的了解，准备整理一下做成文章，跟大家探讨。今天重点说Android手机的录音采集方面的东西。</p>
<h2>语音采集的一些基础指标</h2>
<p>首先要搞清楚的一点是我们的人声是一些声波，是模拟信号，我们计算机的采集是将这些模拟信号转化为数字信号存储起来。我们播放语音文件的时候，是将数字信号转化为模拟信号。说实话，这一块的知识我大学也学得不好，模电我们软件工程的学生没有专门的课程，数电倒是有。不过数电模电的转化这个概念这倒不难理解。这里面就涉及到了采样率和采样位数这两个指标。</p>
<ul>
<li>采样率，或者叫采样频率，指每秒钟取得声音样本的次数。采样率越高，数据越精确。我们也需要了解常用的采样率是多少：8k(8000），16k, 44.1k,48k。8k是电话所用的采样率，对于我们人说的声音的频率，基本在这个采样率之内。所以电话就才采用这个频率采样。48k采样率是CD，DVD所采用的。超过这个频率人耳是分辨不出来的了。</li>
<li>采样位数，说的是每个采样数据占的位数。每个采样数据记录的是振幅, 采样精度取决于采样位数的大小。常用的位数是8位，也就是一个字节。还有16位或者32位 ...</li></ul><p class="subheader">Category: <a href="http://szuwest.github.io/category/ji-zhu.html">技术</a>

    Tagged: 
    <a href="http://szuwest.github.io/tag/sheng-wen-shi-bie-ren-gong-zhi-neng-lu-yin-android.html">声纹识别 人工智能 录音 Android </a>
</p>



<p><a href="http://szuwest.github.io/sheng-wen-shi-bie-zhi-androidshou-ji-lu-yin-cai-ji-tan-tao.html#disqus_thread">comments</a></p>                <a class="button radius secondary small right" href="http://szuwest.github.io/sheng-wen-shi-bie-zhi-androidshou-ji-lu-yin-cai-ji-tan-tao.html">Read More</a>
                <hr  class="gradient"/>
            </article>

            <!-- /#posts-list -->
<div class="pagination-centered">
<h6 class="subheader">Page 1 of 2</h6>

<p>

        <a href="http://szuwest.github.io/category/ji-zhu2.html">Next &raquo;</a>
</p>
</div>

    </div>
    <!-- End Main Content -->

    <!-- Sidebar -->
    <aside class="large-3 columns">
        <h5 class="sidebar-title">Site</h5>
        <ul class="side-nav">
            <li><a href="http://szuwest.github.io/archives.html">Archives</a>
            <li><a href="http://szuwest.github.io/tags.html">Tags</a>


        </ul>

		
        <h5 class="sidebar-title">Categories</h5>
        <ul class="side-nav">
            <li><a href="http://szuwest.github.io/category/android.html">Android</a></li>
            <li><a href="http://szuwest.github.io/category/bian-cheng-jia-gou.html">编程架构</a></li>
            <li><a href="http://szuwest.github.io/category/chan-pin.html">产品</a></li>
            <li><a href="http://szuwest.github.io/category/ios.html">iOS</a></li>
            <li><a href="http://szuwest.github.io/category/ji-zhu.html">技术</a></li>
            <li><a href="http://szuwest.github.io/category/sheng-huo.html">生活</a></li>
            <li><a href="http://szuwest.github.io/category/suan-fa.html">算法</a></li>
   
        </ul>

        <h5 class="sidebar-title">Links</h5>
        <ul class="side-nav">
            <li><a href="http://szuwest.github.io/pages/about.html">About</a></li>
            <li><a href="http://szhanfeng203.blog.163.com/">我的生活博客</a></li>
            <li><a href="http://szuwest.github.io/feeds/all.atom.xml">RSS</a></li>
        </ul>
		
        <h5 class="sidebar-title">Social</h5>
        <ul class="side-nav">
            <li><a href="https://github.com/szuwest">Github</a></li>
            <li><a href="https://twitter.com/szuwest">Twitter</a></li>
            <li><a href="https://www.facebook.com/profile.php?id=1084651913">Facebook</a></li>
            <li><a href="http://weibo.com/szuwest">微博</a></li>
        </ul>

    </aside> <!-- End Sidebar -->

</div> <!-- End Main Content and Sidebar -->


<!-- Footer -->
<footer class="row">
    <div class="large-12 columns">
        <hr />
        <div class="row">
            <div class="large-6 columns">
                <p>West's blog by West</p>
            </div>
            </div>
    </div>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-55687145-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
</footer>